<dom-module id="variant-filter-chromosomal-locator">
    <template>
        <div class="form-group">
            <div class="browser-subsection">
                Chromosomal Location
                <jsorolla-tooltip
                    header="Chromosomal Location"
                    content="Filter out variants falling outside the genomic interval(s) defined"
                ></jsorolla-tooltip>
            </div>
            <div style="padding-top: 5px">
                <textarea class="form-control clearable"
                        rows="3"
                        placeholder="3:444-55555,1:1-100000"
                        value="{{locations::input}}"
                        style="resize: none; font-size: smaller"
                ></textarea>
            </div>
        </div>
    </template>
    <script>

        class VariantFilterChromosomalLocator extends Polymer.Element {

            static get is() {
                return "variant-filter-chromosomal-locator";
            }

            static get properties() {
                return {
                    query: {
                        type: Object,
                        notify: true,
                    },
                    locations: {
                        type: String,
                        value: "",
                        observer: "onLocationsChanged",
                    },
                }
            }

            static get observers() {
                return [
                    'onQueryChanged(query.*)',
                ];
            }

            _attachDom(dom) {
                this.appendChild(dom);
            }

            onQueryChanged() {
                if (!!this.query && !!this.query.region && this.query.region !== this.locations) {
                    this.locations = this.query.region;
                }
            }

            onLocationsChanged() {
                if (!!this.query) {
                    this.query.region = this.locations;
                    this.notifyQueryUpdate();
                }
            }

            notifyQueryUpdate() {
                const params = {
                    detail: {
                        value: this.query,
                    },
                    bubbles: true,
                    composed: true
                };
                this.dispatchEvent(new CustomEvent("query-changed", params));
            }
        }

        customElements.define(VariantFilterChromosomalLocator.is, VariantFilterChromosomalLocator);

    </script>
</dom-module>